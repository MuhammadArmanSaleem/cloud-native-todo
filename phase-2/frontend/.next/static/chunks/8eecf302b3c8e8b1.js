(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(47167),n=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,d=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,u=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&d(e,r,t[r]);if(o)for(var r of o(t))c.call(t,r)&&d(e,r,t[r]);return e},p=(e,t)=>i(e,a(t)),h=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},m=async(e,t)=>{var r,s,n,i,a,o;let l=t||{},c={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:c};for(let d of(null==t?void 0:t.plugins)||[]){if(d.init){let s=await (null==(r=d.init)?void 0:r.call(d,e.toString(),t));l=s.options||l,e=s.url}c.onRequest.push(null==(s=d.hooks)?void 0:s.onRequest),c.onResponse.push(null==(n=d.hooks)?void 0:n.onResponse),c.onSuccess.push(null==(i=d.hooks)?void 0:i.onSuccess),c.onError.push(null==(a=d.hooks)?void 0:a.onError),c.onRetry.push(null==(o=d.hooks)?void 0:o.onRetry)}return{url:e,options:l,hooks:c}},g=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},f=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},y=["get","post","put","patch","delete"],x=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function b(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function v(e){try{return JSON.parse(e)}catch(t){return e}}function j(e){return"function"==typeof e}var w=async(e,t)=>{var r,s,n,i,a,o,l,c;let d,{hooks:k,url:T,options:N}=await m(e,t),R=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&j(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&j(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(N),S=new AbortController,_=null!=(r=N.signal)?r:S.signal,$=function(e,t){let{baseURL:r,params:s,query:n}=t||{query:{},params:{},baseURL:""},i=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r;if(!i)throw TypeError(`Invalid URL ${e}. Are you passing in a relative URL but not setting the baseURL?`);if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];y.includes(t)&&(e=e.replace(`@${t}/`,"/"))}i.endsWith("/")||(i+="/");let[a,o]=e.replace(i,"").split("?"),l=new URLSearchParams(o);for(let[e,t]of Object.entries(n||{}))l.set(e,String(t));if(s)if(Array.isArray(s))for(let[e,t]of a.split("/").filter(e=>e.startsWith(":")).entries()){let r=s[e];a=a.replace(t,r)}else for(let[e,t]of Object.entries(s))a=a.replace(`:${e}`,String(t));(a=a.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(a=a.slice(1));let c=l.size>0?`?${l}`.replace(/\+/g,"%20"):"";return new URL(`${a}${c}`,i)}(T,N),E=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);return b(e.body)&&!t.has("content-type")?JSON.stringify(e.body):e.body}(N),U=function(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,s]of Object.entries((e=>{let t={},r=e=>"function"==typeof e?e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let s=r(e.auth.token);if(!s)return t;t.authorization=`Bearer ${s}`}else if("Basic"===e.auth.type){let s=r(e.auth.username),n=r(e.auth.password);if(!s||!n)return t;t.authorization=`Basic ${btoa(`${s}:${n}`)}`}else if("Custom"===e.auth.type){let s=r(e.auth.value);if(!s)return t;t.authorization=`${r(e.auth.prefix)} ${s}`}}return t})(e)||{}))t.set(r,s);if(!t.has("content-type")){let r=b(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}(N),C=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let s=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return y.includes(s)?s.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(T,N),P=p(u({},N),{url:$,headers:U,body:E,method:C,signal:_});for(let e of k.onRequest)if(e){let t=await e(P);t instanceof Object&&(P=t)}("pipeTo"in P&&"function"==typeof P.pipeTo||"function"==typeof(null==(s=null==t?void 0:t.body)?void 0:s.pipe))&&!("duplex"in P)&&(P.duplex="half");let{clearTimeout:A}=(!(null==N?void 0:N.signal)&&(null==N?void 0:N.timeout)&&(d=setTimeout(()=>null==S?void 0:S.abort(),null==N?void 0:N.timeout)),{abortTimeout:d,clearTimeout:()=>{d&&clearTimeout(d)}}),O=await R(P.url,P);A();let L={response:O,request:P};for(let e of k.onResponse)if(e){let r=await e(p(u({},L),{response:(null==(n=null==t?void 0:t.hookOptions)?void 0:n.cloneResponse)?O.clone():O}));r instanceof Response?O=r:r instanceof Object&&(O=r.response)}if(O.ok){if("HEAD"===P.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let s=t.split(";").shift()||"";return x.test(s)?"json":r.has(s)||s.startsWith("text/")?"text":"blob"}(O),r={data:"",response:O,request:P};if("json"===e||"text"===e){let e=await O.text(),t=null!=(i=P.jsonParser)?i:v;r.data=await t(e)}else r.data=await O[e]();for(let e of((null==P?void 0:P.output)&&P.output&&!P.disableValidation&&(r.data=P.output.parse(r.data)),k.onSuccess))e&&await e(p(u({},r),{response:(null==(a=null==t?void 0:t.hookOptions)?void 0:a.cloneResponse)?O.clone():O}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let D=null!=(o=null==t?void 0:t.jsonParser)?o:v,B=await O.text(),q=!function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(B)?{}:await D(B),F={response:O,request:P,error:p(u({},q),{status:O.status,statusText:O.statusText})};for(let e of k.onError)e&&await e(p(u({},F),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?O.clone():O}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new g({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new g(e);case"exponential":return new f(e);default:throw Error("Invalid retry strategy")}}(t.retry),s=null!=(c=t.retryAttempt)?c:0;if(await r.shouldAttemptRetry(s,O)){for(let e of k.onRetry)e&&await e(L);let n=r.getDelay(s);return await new Promise(e=>setTimeout(e,n)),await w(e,p(u({},t),{retryAttempt:s+1}))}}if(null==t?void 0:t.throw)throw new h(O.status,O.statusText,q);return{data:null,error:p(u({},q),{status:O.status,statusText:O.statusText})}};let k=[],T=0,N=0,R=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=T+4;t<k.length;)k[t]===e?k.splice(t,4):t+=4;let s=t.indexOf(e);~s&&(t.splice(s,1),--r.lc||r.off())}),notify(e,s){N++;let n=!k.length;for(let n of t)k.push(n,r.value,e,s);if(n){for(T=0;T<k.length;T+=4)k[T](k[T+1],k[T+2],k[T+3]);k.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},S=(e,t)=>{var r,s;return r=r=>{let s=t(r);s&&e.events[6].push(s)},s=t=>{let r=e.listen;e.listen=(...s)=>(e.lc||e.active||(e.active=!0,t()),r(...s));let s=e.off;return e.events[6]=[],e.off=()=>{s(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=s}},e.events=e.events||{},e.events[15]||(e.events[15]=s(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],s=t.indexOf(r);t.splice(s,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}};var _=Object.create(null),$=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?_:globalThis),E=new Proxy(_,{get:(e,t)=>$()[t]??_[t],has:(e,t)=>t in $()||t in _,set:(e,t,r)=>($(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=$(!0);return delete r[t],!0},ownKeys:()=>Object.keys($(!0))});"test"===("u">typeof s.default&&s.default.env&&"production"||"")||E.TEST;var U=class extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}};function C(e,t="/api/auth"){return!function(e){try{return"/"!==new URL(e).pathname}catch{throw new U(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e)?(t=t.startsWith("/")?t:`/${t}`,`${e}${t}`):e}var P={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"u">typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},A={id:"add-current-url",name:"Add current URL",hooks:{onRequest(e){if("u">typeof window&&window.location&&window.location)try{let t=new URL(e.url);t.searchParams.set("currentURL",window.location.href),e.url=t}catch{}return e}}},O=(e,t)=>r=>{e.current=r,t()};let{signIn:L,signOut:D,useSession:B}=function(e){var t,s;let{pluginPathMethods:n,pluginsActions:i,pluginsAtoms:a,$fetch:o,$store:l,atomListeners:c}=(e=>{var t;let r,s="credentials"in Request.prototype,n=function(e,t){if(e)return C(e,void 0);let r=E.BETTER_AUTH_URL||E.NEXT_PUBLIC_BETTER_AUTH_URL||E.PUBLIC_BETTER_AUTH_URL||E.NUXT_PUBLIC_BETTER_AUTH_URL||E.NUXT_PUBLIC_AUTH_URL||("/"!==E.BASE_URL?E.BASE_URL:void 0);return r?C(r,void 0):"u">typeof window&&window.location?C(window.location.origin,void 0):void 0}(e?.baseURL),i=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],a=(t={baseURL:n,...s?{credentials:"include"}:{},method:"GET",...e?.fetchOptions,plugins:e?.disableDefaultFetchPlugins?[...e?.fetchOptions?.plugins||[],...i]:[P,A,...e?.fetchOptions?.plugins||[],...i]},async function(e,r){let s,n=p(u(u({},t),r),{plugins:[...(null==t?void 0:t.plugins)||[],(s=t||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,n,i,a;let o=(null==(n=null==(r=s.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:n.schema)||s.schema;if(o){let r=e;(null==(i=o.config)?void 0:i.prefix)&&r.startsWith(o.config.prefix)&&(r=r.replace(o.config.prefix,""),o.config.baseURL&&(e=e.replace(o.config.prefix,o.config.baseURL))),(null==(a=o.config)?void 0:a.baseURL)&&r.startsWith(o.config.baseURL)&&(r=r.replace(o.config.baseURL,""));let s=o.schema[r];if(s){let r=p(u({},t),{method:s.method,output:s.output});return(null==t?void 0:t.disableValidation)||(r=p(u({},r),{body:s.input?s.input.parse(null==t?void 0:t.body):null==t?void 0:t.body,params:s.params?s.params.parse(null==t?void 0:t.params):null==t?void 0:t.params,query:s.query?s.query.parse(null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}})]});if(null==t?void 0:t.catchAllError)try{return await w(e,n)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await w(e,n)}),{$sessionSignal:o,session:l}={session:((e,t,r,s)=>{let n=R({data:null,error:null,isPending:!0,isRefetching:!1}),i=()=>{let e="function"==typeof s?s({data:n.get().data,error:n.get().error,isPending:n.get().isPending}):s;return r(t,{...e,async onSuccess(t){n.set({data:t.data,error:null,isPending:!1,isRefetching:!1}),await e?.onSuccess?.(t)},async onError(t){n.set({error:t.error,data:null,isPending:!1,isRefetching:!1}),await e?.onError?.(t)},async onRequest(t){let r=n.get();n.set({isPending:null===r.data,data:r.data,error:null,isRefetching:!0}),await e?.onRequest?.(t)}})};e=Array.isArray(e)?e:[e];let a=!1;for(let t of e)t.subscribe(()=>{a?i():S(n,()=>(i(),a=!0,()=>{n.off(),t.off()}))});return n})(r=R(!1),"/get-session",a,{method:"GET"}),$sessionSignal:r},c=e?.plugins||[],d={},h={$sessionSignal:o,session:l},m={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST"},g=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||e.startsWith("/sign-in")||e.startsWith("/sign-up")}];for(let e of c)e.getAtoms&&Object.assign(h,e.getAtoms?.(a)),e.pathMethods&&Object.assign(m,e.pathMethods),e.atomListeners&&g.push(...e.atomListeners);let f={notify:e=>{h[e].set(!h[e].get())},listen:(e,t)=>{h[e].subscribe(t)},atoms:h};for(let e of c)e.getActions&&Object.assign(d,e.getActions?.(a,f));return{pluginsActions:d,pluginsAtoms:h,pluginPathMethods:m,atomListeners:g,$fetch:a,$store:f}})(e),d={};for(let[e,t]of Object.entries(a)){d[`use${(s=e).charAt(0).toUpperCase()+s.slice(1)}`]=()=>(function(e,{keys:t,deps:s=[e,t]}={}){let n=(0,r.useRef)();n.current=e.get();let i=(0,r.useCallback)(r=>{var s;let i;return(t?.length||0)>0?(s=O(n,r),i=new Set(t).add(void 0),e.listen((e,t,r)=>{i.has(r)&&s(e,t,r)})):e.listen(O(n,r))},s),a=()=>n.current;return(0,r.useSyncExternalStore)(i,a,a)})(t)}return t={...i,...d,$fetch:o,$store:l},function e(r=[]){return new Proxy(function(){},{get(s,n){let i=[...r,n],a=t;for(let e of i)if(a&&"object"==typeof a&&e in a)a=a[e];else{a=void 0;break}return"function"==typeof a?a:e(i)},apply:async(e,t,s)=>{let i="/"+r.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),l=s[0]||{},d=s[1]||{},{query:u,fetchOptions:p,...h}=l,m={...d,...p},g=function(e,t,r){let s=t[e],{fetchOptions:n,query:i,...a}=r||{};return s||(n?.method?n.method:a&&Object.keys(a).length>0?"POST":"GET")}(i,n,l);return await o(i,{...m,body:"GET"===g?void 0:{...h,...m?.body||{}},query:u||m?.query,method:g,async onSuccess(e){await m?.onSuccess?.(e);let t=c?.find(e=>e.matcher(i));if(!t)return;let r=a[t.signal];if(!r)return;let s=r.get();setTimeout(()=>{r.set(!s)},10)}})}})}()}({baseURL:s.default.env.NEXT_PUBLIC_BETTER_AUTH_URL||"http://localhost:8000"}),q=new class{baseUrl;token;constructor(){this.baseUrl=s.default.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",this.token=null}setToken(e){this.token=e}async getTasks(e){let t=new URLSearchParams;e?.status&&t.append("status",e.status),e?.priority&&t.append("priority",e.priority),e?.tags&&t.append("tags",e.tags),e?.search&&t.append("search",e.search),e?.sort&&t.append("sort",e.sort),e?.order&&t.append("order",e.order);let r=`${this.baseUrl}/api/tasks${t.toString()?`?${t.toString()}`:""}`,s=await fetch(r,{headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}});if(!s.ok)throw Error(`Failed to fetch tasks: ${s.statusText}`);return(await s.json()).tasks||[]}async createTask(e){let t=await fetch(`${this.baseUrl}/api/tasks`,{method:"POST",headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(`Failed to create task: ${t.statusText}`);return await t.json()}async updateTask(e,t){let r=await fetch(`${this.baseUrl}/api/tasks/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error(`Failed to update task: ${r.statusText}`);return await r.json()}async deleteTask(e){let t=await fetch(`${this.baseUrl}/api/tasks/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${this.token}`}});if(!t.ok)throw Error(`Failed to delete task: ${t.statusText}`);return await t.json()}async toggleTaskCompletion(e){let t=await fetch(`${this.baseUrl}/api/tasks/${e}/complete`,{method:"PATCH",headers:{Authorization:`Bearer ${this.token}`}});if(!t.ok)throw Error(`Failed to toggle task completion: ${t.statusText}`);return await t.json()}};function F({priority:e,size:r="md"}){if(!e)return null;let s={high:{color:"bg-red-500",label:"High"},medium:{color:"bg-yellow-500",label:"Medium"},low:{color:"bg-green-500",label:"Low"}}[e];return(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{className:`${"sm"===r?"w-2 h-2":"w-3 h-3"} ${s.color} rounded-full`,"aria-label":s.label}),(0,t.jsx)("span",{className:"text-xs text-gray-600",children:s.label})]})}function I({children:e,onClick:r,variant:s="primary",size:n="md",disabled:i=!1,type:a="button",className:o=""}){return(0,t.jsx)("button",{type:a,className:`font-medium rounded transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"}[s]} ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[n]} ${i?"opacity-50 cursor-not-allowed":""} ${o}`,onClick:r,disabled:i,children:e})}function W({task:e,onToggleComplete:r,onEdit:s,onDelete:n}){let i=e.due_date&&new Date(e.due_date)<new Date&&!e.completed,a=e.due_date&&!i&&new Date(e.due_date).getTime()-Date.now()<864e5;return(0,t.jsx)("li",{className:"p-4 border-b border-gray-200 hover:bg-gray-50 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,t.jsx)("input",{type:"checkbox",checked:e.completed,onChange:()=>r(e.id),className:"mt-1 h-4 w-4 text-blue-600 rounded focus:ring-blue-500","aria-label":`Mark task "${e.title}" as ${e.completed?"incomplete":"complete"}`}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("h3",{className:`text-base font-medium ${e.completed?"line-through text-gray-500":"text-gray-900"}`,children:e.title}),e.priority&&(0,t.jsx)(F,{priority:e.priority,size:"sm"}),e.recurring_pattern&&(0,t.jsx)("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded",children:e.recurring_pattern})]}),e.description&&(0,t.jsx)("p",{className:`text-sm text-gray-600 mb-2 ${e.completed?"line-through":""}`,children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[e.tags&&e.tags.length>0&&(0,t.jsx)("div",{className:"flex gap-1.5 flex-wrap",children:e.tags.map(e=>(0,t.jsx)("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-0.5 rounded",children:e},e))}),e.due_date&&(0,t.jsxs)("span",{className:`text-xs ${i?"text-red-600 font-medium":a?"text-yellow-600 font-medium":"text-gray-500"}`,children:["Due: ",new Date(e.due_date).toLocaleDateString()]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(I,{variant:"ghost",size:"sm",onClick:()=>s(e),disabled:e.completed,children:"Edit"}),(0,t.jsx)(I,{variant:"danger",size:"sm",onClick:()=>{confirm(`Delete task "${e.title}"?`)&&n(e.id)},children:"Delete"})]})]})})}function z({tasks:e,onToggleComplete:r,onEdit:s,onDelete:n,emptyMessage:i="No tasks found"}){return 0===e.length?(0,t.jsx)("div",{className:"p-12 text-center",children:(0,t.jsx)("p",{className:"text-gray-500 text-lg",children:i})}):(0,t.jsx)("ul",{className:"divide-y divide-gray-200",children:e.map(e=>(0,t.jsx)(W,{task:e,onToggleComplete:r,onEdit:s,onDelete:n},e.id))})}function H(e){return e.replace(/<[^>]*>/g,"").replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/on\w+\s*=\s*["'][^"']*["']/gi,"").replace(/javascript:/gi,"").trim()}function M(e){return!(/<script/i.test(e)||/on\w+\s*=/i.test(e)||/javascript:/i.test(e)||/data:text\/html/i.test(e))}function G({label:e,error:r,className:s="",...n}){return(0,t.jsxs)("div",{children:[e&&(0,t.jsx)("label",{htmlFor:n.id,className:"block text-sm font-medium text-gray-700 mb-1.5",children:e}),(0,t.jsx)("input",{className:`
          w-full 
          px-3 py-2 
          border rounded-md 
          text-gray-900 
          placeholder-gray-400
          focus:outline-none 
          focus:ring-2 
          focus:ring-blue-500 
          focus:border-transparent
          ${r?"border-red-300":"border-gray-300"}
          ${s}
        `,...n}),r&&(0,t.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:r})]})}function J({task:e,onSubmit:s,onCancel:n,isSubmitting:i=!1}){let[a,o]=(0,r.useState)({title:e?.title||"",description:e?.description||"",priority:e?.priority||"medium",tags:e?.tags||[],due_date:e?.due_date?e.due_date.split("T")[0]:"",reminder_time:e?.reminder_time?e.reminder_time.split("T")[0]+"T"+e.reminder_time.split("T")[1]:"",recurring_pattern:e?.recurring_pattern||void 0}),[l,c]=(0,r.useState)({}),[d,u]=(0,r.useState)(""),p=e=>{let{name:t,value:r}=e.target,s="title"===t||"description"===t?H(r):r;o(e=>({...e,[t]:s})),l[t]&&c(e=>{let r={...e};return delete r[t],r})},h=()=>{if(!d.trim())return;let e=H(d.trim());e&&!a.tags?.includes(e)&&(o(t=>({...t,tags:[...t.tags||[],e]})),u(""))},m=async e=>{e.preventDefault();let t=function(e){let t={};if(e.title&&e.title.trim()){let r=H(e.title);M(r)?r.length<1?t.title="Title cannot be empty":r.length>200&&(t.title="Title must be 200 characters or less"):t.title="Invalid characters detected"}else t.title="Title is required";if(e.description){let r=H(e.description);M(r)?r.length>1e3&&(t.description="Description must be 1000 characters or less"):t.description="Invalid characters detected"}if(e.due_date&&isNaN(new Date(e.due_date).getTime())&&(t.due_date="Invalid date format"),e.reminder_time){let r=new Date(e.reminder_time);isNaN(r.getTime())?t.reminder_time="Invalid time format":e.due_date&&r>new Date(e.due_date)&&(t.reminder_time="Reminder time must be before due date")}return t}(a);Object.keys(t).length>0?c(t):await s(a)};return(0,t.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,t.jsx)(G,{label:"Title *",name:"title",value:a.title,onChange:p,error:l.title,required:!0,maxLength:200}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Description"}),(0,t.jsx)("textarea",{id:"description",name:"description",value:a.description||"",onChange:p,rows:3,maxLength:1e3,className:`
            w-full px-3 py-2 border rounded-md
            text-gray-900 placeholder-gray-400
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
            ${l.description?"border-red-300":"border-gray-300"}
          `}),l.description&&(0,t.jsx)("p",{className:"mt-1.5 text-sm text-red-600",children:l.description})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Priority"}),(0,t.jsxs)("select",{id:"priority",name:"priority",value:a.priority||"medium",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"low",children:"Low"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"high",children:"High"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Tags"}),(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("input",{type:"text",id:"tags",value:d,onChange:e=>u(H(e.target.value)),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),h())},placeholder:"Add a tag and press Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,t.jsx)(I,{type:"button",variant:"secondary",onClick:h,children:"Add"})]}),a.tags&&a.tags.length>0&&(0,t.jsx)("div",{className:"flex gap-2 flex-wrap",children:a.tags.map(e=>(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-700 text-sm rounded",children:[e,(0,t.jsx)("button",{type:"button",onClick:()=>{o(t=>({...t,tags:t.tags?.filter(t=>t!==e)||[]}))},className:"text-gray-500 hover:text-gray-700","aria-label":`Remove tag ${e}`,children:"×"})]},e))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(G,{label:"Due Date",name:"due_date",type:"date",value:a.due_date||"",onChange:p,error:l.due_date}),(0,t.jsx)(G,{label:"Reminder Time",name:"reminder_time",type:"datetime-local",value:a.reminder_time||"",onChange:p,error:l.reminder_time})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"recurring_pattern",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Recurring Pattern"}),(0,t.jsxs)("select",{id:"recurring_pattern",name:"recurring_pattern",value:a.recurring_pattern||"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"",children:"None"}),(0,t.jsx)("option",{value:"daily",children:"Daily"}),(0,t.jsx)("option",{value:"weekly",children:"Weekly"}),(0,t.jsx)("option",{value:"monthly",children:"Monthly"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)(I,{type:"button",variant:"secondary",onClick:n,disabled:i,children:"Cancel"}),(0,t.jsx)(I,{type:"submit",disabled:i,children:i?"Saving...":e?"Update Task":"Create Task"})]})]})}function X({filters:e,onFiltersChange:r,availableTags:s}){let n=(t,s)=>{r({...e,[t]:s||void 0})},i=Object.keys(e).length>0;return(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters & Search"}),i&&(0,t.jsx)(I,{variant:"ghost",size:"sm",onClick:()=>{r({})},children:"Clear All"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(G,{label:"Search",name:"search",type:"text",value:e.search||"",onChange:e=>n("search",e.target.value),placeholder:"Search tasks..."}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Status"}),(0,t.jsxs)("select",{id:"status",value:e.status||"all",onChange:e=>n("status","all"===e.target.value?void 0:e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"all",children:"All"}),(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Priority"}),(0,t.jsxs)("select",{id:"priority",value:e.priority||"",onChange:e=>n("priority",e.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"",children:"All Priorities"}),(0,t.jsx)("option",{value:"high",children:"High"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"low",children:"Low"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"sort",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Sort By"}),(0,t.jsxs)("select",{id:"sort",value:e.sort||"created_at",onChange:e=>n("sort",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"created_at",children:"Created Date"}),(0,t.jsx)("option",{value:"due_date",children:"Due Date"}),(0,t.jsx)("option",{value:"priority",children:"Priority"}),(0,t.jsx)("option",{value:"title",children:"Title"})]})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-700",children:"Order:"}),(0,t.jsx)(I,{variant:"asc"===e.order?"primary":"secondary",size:"sm",onClick:()=>n("order","asc"===e.order?"desc":"asc"),children:"asc"===e.order?"↑ Ascending":"↓ Descending"})]})]})}function K(){let e,{signIn:s,signOut:n,session:i}={session:(e=B()).data?{user:e.data.user,token:e.data.session?.token||""}:null,signIn:L.email,signOut:D},a=async()=>{let e=prompt("Email:"),t=prompt("Password:");if(e&&t)try{await s({email:e,password:t})}catch(e){alert("Sign in failed. Please check your credentials.")}},[o,l]=(0,r.useState)([]),[c,d]=(0,r.useState)(!0),[u,p]=(0,r.useState)(!1),[h,m]=(0,r.useState)(null),[g,f]=(0,r.useState)({}),[y,x]=(0,r.useState)(!1),b=async()=>{if(i?.token)try{q.setToken(i.token);let e=await q.getTasks(g);l(e)}catch(e){console.error("Error fetching tasks:",e)}finally{d(!1)}};(0,r.useEffect)(()=>{i?(d(!0),b()):d(!1)},[i,g]);let v=async e=>{if(i?.token){x(!0);try{q.setToken(i.token),h?await q.updateTask(h.id,e):await q.createTask(e),p(!1),m(null),await b()}catch(e){console.error("Error saving task:",e),alert("Failed to save task. Please try again.")}finally{x(!1)}}},j=async e=>{if(i?.token)try{q.setToken(i.token),await q.toggleTaskCompletion(e),await b()}catch(e){console.error("Error toggling task:",e)}},w=async e=>{if(i?.token)try{q.setToken(i.token),await q.deleteTask(e),await b()}catch(e){console.error("Error deleting task:",e),alert("Failed to delete task. Please try again.")}},k=Array.from(new Set(o.flatMap(e=>e.tags||[])));return c?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-xl font-medium text-gray-700",children:"Loading..."})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Todo App"}),(0,t.jsx)("div",{className:"flex items-center gap-4",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:i.user?.email}),(0,t.jsx)(I,{variant:"secondary",onClick:()=>n(),children:"Sign Out"})]}):(0,t.jsx)(I,{onClick:a,children:"Sign In"})})]})})}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:i?(0,t.jsxs)(t.Fragment,{children:[u&&(0,t.jsxs)("div",{className:"mb-6 bg-white p-6 rounded-lg border border-gray-200",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:h?"Edit Task":"Create New Task"}),(0,t.jsx)(J,{task:h,onSubmit:v,onCancel:()=>{p(!1),m(null)},isSubmitting:y})]}),!u&&(0,t.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Your Tasks"}),(0,t.jsx)(I,{onClick:()=>p(!0),children:"+ New Task"})]}),!u&&(0,t.jsx)(X,{filters:g,onFiltersChange:f,availableTags:k}),!u&&(0,t.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,t.jsx)(z,{tasks:o,onToggleComplete:j,onEdit:e=>{m(e),p(!0)},onDelete:w,emptyMessage:Object.keys(g).length>0?"No tasks match your filters. Try adjusting your search criteria.":"No tasks yet. Create your first task above!"})})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"Please sign in to manage your tasks"}),(0,t.jsx)(I,{onClick:a,children:"Sign In"})]})})]})}e.s(["default",()=>K],31713)}]);